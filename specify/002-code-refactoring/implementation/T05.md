# 实现记录 - T05

## 任务信息
- **编号**: T05
- **描述**: 创建 banner-blocker.js 模块：实现 hideAll 和 showAll 方法处理社区 banner 隐藏

## 实现细节

### 模块设计
创建了 `SilentReddit.bannerBlocker` 对象，提供社区 banner 隐藏和显示功能。

### 核心方法

#### 1. hideAll(targetNode = document) 方法
隐藏所有社区 banner 背景图片：
```javascript
hideAll(targetNode = document) {
    targetNode.querySelectorAll(SilentReddit.SELECTORS.COMMUNITY_BANNER).forEach(banner => {
        // Skip if already processed
        if (banner.hasAttribute(SilentReddit.DATA_ATTRS.BANNER_PROCESSED)) {
            return;
        }

        // Save original background and hide
        banner.setAttribute(SilentReddit.DATA_ATTRS.BANNER_PROCESSED, 'true');
        banner.setAttribute(SilentReddit.DATA_ATTRS.ORIGINAL_BANNER_BG, banner.style.cssText);
        banner.style.setProperty('background-image', 'none', 'important');
    });
}
```

**关键特性：**
- 支持 `targetNode` 参数，可处理全页面或指定节点
- 幂等性：通过 `BANNER_PROCESSED` 属性标记避免重复处理
- 保存完整的原始样式字符串（`style.cssText`）
- 使用 `!important` 确保样式覆盖

#### 2. showAll() 方法
显示所有隐藏的 banner：
```javascript
showAll() {
    document.querySelectorAll(SilentReddit.SELECTORS.BANNER_PROCESSED).forEach(banner => {
        // Restore original background
        const originalBg = banner.getAttribute(SilentReddit.DATA_ATTRS.ORIGINAL_BANNER_BG);
        if (originalBg) {
            banner.style.cssText = originalBg;
        } else {
            banner.style.removeProperty('background-image');
        }

        // Remove data attributes
        banner.removeAttribute(SilentReddit.DATA_ATTRS.BANNER_PROCESSED);
        banner.removeAttribute(SilentReddit.DATA_ATTRS.ORIGINAL_BANNER_BG);
    });
}
```

**关键特性：**
- 使用专门的选择器快速查找已处理的 banner
- 恢复完整的原始样式
- 清理所有数据属性标记

### 设计原则
- ✅ 接口统一：提供标准的 hideAll/showAll 接口（符合 D01 讨论）
- ✅ 幂等性：多次隐藏不会叠加样式
- ✅ 可逆性：完整恢复原始样式
- ✅ 支持动态内容：通过 targetNode 参数处理新增节点

### 日志
模块加载时输出：`[SR] Banner blocker module loaded`

---
*创建时间: 2025-10-18*
