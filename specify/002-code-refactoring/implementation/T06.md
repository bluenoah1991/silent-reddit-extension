# 实现记录 - T06

## 任务信息
- **编号**: T06
- **描述**: 创建 ads-blocker.js 模块：实现 hideAll、showAll 和 hideNode 方法处理广告屏蔽

## 实现细节

### 模块设计
创建了 `SilentReddit.adsBlocker` 对象，提供广告屏蔽功能。

### 核心方法

#### 1. hideAll(targetNode = document) 方法
隐藏所有广告元素：
```javascript
hideAll(targetNode = document) {
    targetNode.querySelectorAll(SilentReddit.SELECTORS.ADS).forEach(ad => {
        ad.style.setProperty('display', 'none', 'important');
    });
}
```

**特点：**
- 支持 targetNode 参数，可处理全页面或指定节点
- 使用 `!important` 确保样式优先级
- 简单直接，不需要保存原始状态（广告元素本身就应该隐藏）

#### 2. showAll() 方法
显示所有隐藏的广告：
```javascript
showAll() {
    document.querySelectorAll(SilentReddit.SELECTORS.ADS).forEach(ad => {
        ad.style.removeProperty('display');
    });
}
```

**特点：**
- 移除 display 属性，恢复元素默认显示状态
- 不需要数据属性标记（广告元素可重复处理）

#### 3. hideNode(node) 方法
快速隐藏单个广告节点：
```javascript
hideNode(node) {
    if (node && node.matches && node.matches(SilentReddit.SELECTORS.ADS)) {
        node.style.setProperty('display', 'none', 'important');
    }
}
```

**特点：**
- 专为动态内容处理设计（MutationObserver 回调中使用）
- 先检查节点是否匹配广告选择器
- 快速响应，立即隐藏新出现的广告

### 设计简化
根据 D01 和 D02 讨论，广告屏蔽模块采用简化设计：
- ✅ 不使用数据属性标记（广告元素不需要跟踪状态）
- ✅ hideAll 方法幂等（重复调用不产生副作用）
- ✅ 提供 hideNode 方法用于快速处理单个节点
- ✅ 接口统一：hideAll/showAll + 额外的 hideNode

### 广告选择器
使用常量中定义的选择器：
- `shreddit-ad-post` - 帖子中的广告
- `shreddit-comments-page-ad` - 评论页广告
- `games-section-badge-controller` - 游戏板块徽章
- `shreddit-gallery-carousel` - 画廊轮播广告

### 日志
模块加载时输出：`[SR] Ads blocker module loaded`

---
*创建时间: 2025-10-18*
