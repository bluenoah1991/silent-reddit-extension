````markdown
# 实现记录 - T21

## 任务信息
- **编号**: T21
- **描述**: 在icons-replacer.js的showAll方法中添加版主列表头像的恢复逻辑，确保切换设置时能正确恢复显示

## 实现细节

### 修改文件
- `icons-replacer.js`

### 变更内容

在 `showAll` 方法中，在移除所有字母头像之前，添加了以下代码：

**新增代码**：
```javascript
// Restore moderator list avatars
document.querySelectorAll(SilentReddit.SELECTORS.MODERATOR_LIST_ITEM).forEach(tracker => {
    const listItem = tracker.closest('li');
    if (!listItem) return;

    // Find all replaced avatars in this list item
    const replacedAvatars = listItem.querySelectorAll('img[' + SilentReddit.DATA_ATTRS.ICON_REPLACED + '], .snoovatar[' + SilentReddit.DATA_ATTRS.ICON_REPLACED + ']');
    replacedAvatars.forEach(avatar => {
        // Restore img elements
        if (avatar.tagName === 'IMG') {
            const originalSrc = avatar.getAttribute(SilentReddit.DATA_ATTRS.ORIGINAL_SRC);
            if (originalSrc) {
                avatar.src = originalSrc;
                avatar.removeAttribute(SilentReddit.DATA_ATTRS.ORIGINAL_SRC);
            }
            avatar.style.cssText = avatar.getAttribute(SilentReddit.DATA_ATTRS.ORIGINAL_STYLE) || '';
            avatar.removeAttribute(SilentReddit.DATA_ATTRS.ORIGINAL_STYLE);
            avatar.removeAttribute(SilentReddit.DATA_ATTRS.ICON_REPLACED);
        }
        // Restore snoovatar containers
        else if (avatar.classList.contains('snoovatar')) {
            avatar.style.cssText = avatar.getAttribute(SilentReddit.DATA_ATTRS.ORIGINAL_STYLE) || '';
            avatar.removeAttribute(SilentReddit.DATA_ATTRS.ORIGINAL_STYLE);
            avatar.removeAttribute(SilentReddit.DATA_ATTRS.ICON_REPLACED);
        }
    });
});
```

### 实现说明

**功能描述**：
恢复版主列表中所有被替换的头像，确保切换设置时能正确显示原始头像。

**工作流程**：
1. 使用 `MODERATOR_LIST_ITEM` 选择器查找所有版主列表项
2. 从每个 tracker 向上查找包含它的 `<li>` 元素
3. 在该 `<li>` 内查找所有带有 `data-sr-icon-replaced` 标记的头像
4. 分别处理不同类型的头像：
   - **img元素**：恢复原始src、style，移除所有标记属性
   - **snoovatar容器**：恢复原始style，移除标记属性
5. 最后统一移除所有字母头像（在方法最后执行）

**恢复的属性**：
- `src` - 原始图片地址（仅img元素）
- `style.cssText` - 原始样式
- 移除 `data-sr-icon-replaced` 标记
- 移除 `data-sr-original-src` 标记
- 移除 `data-sr-original-style` 标记

**执行时机**：
- 用户在设置中禁用头像替换功能时
- 在移除字母头像元素之前执行

**与hideAll的对应关系**：
- `hideAll` 调用 `_replaceModeratorListAvatars` 隐藏头像
- `showAll` 执行版主列表头像恢复逻辑显示头像
- 形成完整的显示/隐藏切换循环

---
*创建时间: 2025-10-19*
````